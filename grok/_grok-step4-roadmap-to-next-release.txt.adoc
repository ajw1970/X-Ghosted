= Grok Step 4: Roadmap to Next Release
:revision-date: March 30, 2025

== Roadmap to Next Version Release (0.6.1)
1. *DOM-Driven Detection*: Tag container (`data-xGhosted="posts-container"`, `tabindex="0"`, log `aria-label`), posts (`data-xGhosted="postquality.<quality>"`, `data-xGhosted-id="link"`, `xGhosted-<quality>` classes). Fail with message if not found. Complete—implemented in `xGhosted.js`.
2. *MutationObserver Update*: Watch `[data-xGhosted="posts-container"]` children, re-init on refresh with 5s timeout. DOM-settling check tabled. Complete—implemented in `xGhosted.js`.
3. *Manual Test*: Verify tagging, highlighting, fail message on 50+ post page. Implemented—pending verification.
4. *Deferred Tasks*: Show/Hide fix (done), POTENTIAL_PROBLEM detection (resolved via DOM tagging and thread check), Clear/Export CSV reset (done)—shifted below DOM work.
5. *Rate Limit Handling*: Ensure `checkPostInNewTab` handles rate limits by pausing and resuming operations. Complete—verified through tests.
6. *Preact UI/UX Integration*: Move UI/UX logic to Preact with HTM, loaded via CDN. In progress: Theme management moved to `Panel` component in `src/ui/Components.js` (March 30, 2025); next step is to refactor `togglePanelVisibility` to use Preact state.

== Next Steps for Continuation
- Fix remaining test failures in `src/xGhosted.test.js` (related to Preact rendering and DOM querying).
- Refactor `togglePanelVisibility` to integrate with Preact, moving visibility logic into the `Panel` component.
- Verify manual testing for 50+ posts on `/with_replies`.
- Finalize 0.6.1 release with updated documentation.
- Plan enhancements (e.g., auto-collapse toggle, UI refinements).

== Revision History
- March 23, 2025: Step 2 completed—24/24 tests passing.
- March 24, 2025: Step 5 completed—userscript wrapper with esbuild.
- March 26, 2025: Fixed `build-xGhosted.js`, 1000-article cap, "Hide" functionality.
- March 27, 2025: Added manual testing findings.
- March 28, 2025: Refined `checkPostInNewTab` and `highlightPosts`, manual testing implemented but unverified.
- March 28, 2025: Resolved rate limit test failure and confirmed all tasks complete.
- March 30, 2025: Added Preact UI/UX integration step, updated next steps to include test fixes and `togglePanelVisibility` refactoring.
