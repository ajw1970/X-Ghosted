// File: grok/_grok-step2-expected-project-behavior.txt.adoc
= Grok Step 2: Working Understanding of X-Ghosted Project
:author: ajw1970
:date: March 16, 2025
:revdate: March 24, 2025

== Overview
X-Ghosted, a Tampermonkey userscript, flags problematic X.com posts with visual cues, with special focus on the user's profile replies feed. Version 0.6.1 (post commit 2ecaf8f49) sharpens detection and tests, powered by a lean `identifyPost.js`, with state persistence via `GM_setValue`/`GM_getValue`.

== Core Features
- *Detection*: Tags posts:
  - *Problems*: Looks for offical X System Notices or Links to Communities known to be problems (red).
  - *Potential Problems*: "Hanging chads" that show up in the replies feed looking disconnected from discussions. (yellow).
  - *Good*: Normal posts (green post-check). We don't need to draw attention to these.
  - *Undefined*: Filler, deterministic IDs (e.g., `/prev/status/123#fillerN`).
- *UI*: Highlights (red/yellow/green/none) in `xGhosted.js`; 0.6.0 panel with PROBLEM/POTENTIAL_PROBLEM links, Copy button, theme toggle—all live. Start/Stop/Reset collapsing controls persist via `GM_setValue`. CSV export (5s throttle) added; Manual Check toggle added; tab checks in progress.
- *Testing*: `identifyPosts.test.js` nails detection; `xGhosted.test.js` locks integration (24 tests passing); `src/dom/` tests (e.g., `createPanel.test.js` fixed) solid—all passing as of March 23, 2025.

== Next Steps
- Follow roadmap in Step 4: UI polish next, userscript wrap, then stress-testing, and collapsing last.

== Notes
- Latest repo activity via link:https://github.com/ajw1970/X-Ghosted[X-Ghosted], latest commit.
- Details in Step 3—keep this tight. We're here to get work done, not play all day.
- Large updates might hit attachment snags—new prompts if needed.
- *History*: 0.5.0 had flat state (e.g., `processedArticles`, `problemLinks`), single yellow highlight, no persistence. 0.6.0 introduced `state` object, richer features (collapsing, multi-color highlights), but light testing. 0.6.0’s structure wins—basis for 0.6.1’s modular, tested `xGhosted.js`, with userscript wrapper later per Step 4 roadmap.
- *Lesson Learned March 23, 2025*: Sample HTML (36 posts: 21 GOOD, 1 PROBLEM, 2 POTENTIAL_PROBLEM, 12 UNDEFINED) is key for validating counts—e.g., CSV export should match 3 flagged posts.
- *CRITICAL NOTE March 23, 2025*: Step 1 principles and this file’s directives are absolute—Grok ignores them at its peril. Live input refines, but never overrides this foundation unless I say “Switch it up.” No more slip-ups.
- *Lesson Learned March 23, 2025*: Micro-edits cause errors—replacement blocks (e.g., `checkPostInNewTab`, test blocks) beat full dumps for sync and speed.

== Revision History
- March 16, 2025: Initial sketch.
- March 21, 2025: Aligned with 0.6.1, trimmed.
- March 23, 2025: Noted `identifyPost.js` fix success, added state persistence details. *Updated with 0.5.0 vs. 0.6.0 analysis—0.6.0’s structured state drives 0.6.1’s modular evolution.*
- March 22, 2025: Added deterministic IDs, highlights, DOM extraction, 1 failure status.
- March 23, 2025: Updated for `createPanel.test.js` fix, integrated `GM_setValue`/`GM_getValue` for state.
- March 23, 2025: Updated for 0.6.1—18 tests pass in `xGhosted.test.js`. Beefed up `'highlightPosts applies correct borders'` test—handles UNDEFINED posts without `<article>`. Added lesson: sample data specificity guides feature validation.
- March 23, 2025: CSV export added—5s throttled, button in panel via `createPanel.js`. Roadmap moved to Step 4.
- March 23, 2025: Step 2 completed—24/24 tests pass with Manual Check Mode in `xGhosted.js` and `createPanel.js`.
- March 24, 2025: Updated to clarify intentions.