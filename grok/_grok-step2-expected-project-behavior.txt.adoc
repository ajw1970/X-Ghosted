= Grok Step 2: Expected Project Behavior
:revision-date: March 25, 2025

== Core Features in Current State
- **Detection**: Highlights PROBLEM (red), POTENTIAL_PROBLEM (yellow), GOOD (none), UNDEFINED (none) posts on X’s `/with_replies` pages using local DOM analysis only.
- **UI**: Floating panel (resizable, draggable) lists problem/potential posts with Copy, Export CSV (5s throttled), Import CSV, Clear, and Manual Check buttons. Theme switching (dark/dim/light) is seamless with tooltips.
- **Persistence**: State saved via `GM_setValue`/`GM_getValue`—loads/saves `processedArticles` (capped at 1000), settings, and panel position.
- **Logging**: Configurable via constructor—uses `GM_log` or `console.log`.
- **Safety**: Starts with `isManualCheckEnabled` true to limit server activity; 500ms debounce and 1s observer throttle reduce resource use. No server requests beyond page loads.
- **Tests**: `src/xGhosted.test.js`—28 tests defined, currently all failing due to a `SyntaxError` from duplicate `setupJSDOM` declaration. Previously, 27/28 passed, with CSV export test failing due to `navigator.clipboard` mocking issues.
- **Build**: `build-xGhosted.js` script successfully bundles `xGhosted.js` with dependencies into `xGhosted.user.js`, with method deduplication fixed to ensure clean, Prettier-formatted output.

== Next Steps
- Fix `SyntaxError` in `src/xGhosted.test.js` to restore test suite (28 tests) and verify Step 5 functionality.
- Transition from the custom `build-xGhosted.js` script to Rollup for bundling `xGhosted.js` with its dependencies, improving maintainability and ensuring cleaner, more readable output.
- Follow the roadmap in Step 4—Step 6 (Tab Check GOOD Posts) is next, to be implemented with user-triggered controls to maintain server safety.

== Revision History
- March 23, 2025: Step 2 completed—24/24 tests pass with Manual Check Mode mocked. CSV export added.
- March 24, 2025: Step 3 completed—CSV import/clear added. Step 4 completed—UI polished. Step 5 completed—userscript wrapper built with resource caps (1000 articles) and server safety (manual mode, DOM-only). Build script fixed for method deduplication and Prettier formatting. Plan to transition to Rollup for bundling established.
- March 25, 2025: Test suite regressed—28/28 tests fail due to `SyntaxError` from duplicate `setupJSDOM`. Previously, 27/28 passed, with CSV export test failing on `navigator.clipboard`. Fix pending before Rollup transition.

== Notes
Large updates might hit X post size limits—Grok will flag truncation if detected and pause for new prompts.